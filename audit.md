# CladHunter Development Checklist (Q4 2025)

Документ служит рабочей «панелью управления» для завершения разработки и запусков CladHunter на домене `https://cladhunter.app`. Отмечайте чекбоксы по мере выполнения, фиксируйте результаты в pull request или ежедневном стендапе.

---

## Как работать с чеклистом

- В начале недели пройдитесь по разделу **Фаза 0** и проверьте статусы зависимостей.
- Каждый рабочий день фиксируйте прогресс в разделе «Текущие блокеры» и синхронизируйте план на пару следующих шагов.
- Любое изменение архитектуры, API или экономики отражайте в README, `docs/DEPLOYMENT.md` и `docs/PRODUCT_ANALYSIS.md`, чтобы команда оставалась в контексте.
- После закрытия пункта добавляйте ссылку на тикет / PR рядом с чекбоксом (`[x] ... (PR #123)`).

---

## Текущие блокеры

- [ ] **TonConnect авторизация**: фронтенд отправляет кошелёк, но backend/database не фиксируют привязку. Разобрать цепочку `MiningScreen -> useTonConnect -> POST /api/auth/ton-connect` и убедиться, что:
  - [ ] В dev/prod окружениях установлен правильный `VITE_BACKEND_URL`.
  - [ ] Backend логирует входящие запросы и ошибки БД (проверить `backend/src/routes/auth.ts` и сервисы работы с `user_tokens`).
  - [ ] Neon принимает соединения и применяются транзакции (лог `watch_logs`, `user_tokens`).
  - [ ] После починки задокументировать процедуру тестирования в разделе «Фаза 4. Интеграция».

---

## Быстрые ссылки

- `README.md` — обзор архитектуры и быстрый старт.
- `docs/DEPLOYMENT.md` — запуск окружений Render/Vercel/Neon.
- `docs/PRODUCT_ANALYSIS.md` — продуктовый бэклог и метрики.
- `agent.md` — инженерный плейбук.
- `guidelines/Guidelines.md` — рабочие правила и чек-ин структура.

---

## Фаза 0. Организация и контроль

- [ ] Проверить, что `.env` файлы заполнены (см. `README.md` → «Key Environment Variables»).
- [ ] Обновить npm зависимости (`npm install --workspaces`) и убедиться, что локальные скрипты запускаются.
- [ ] Сверить сроки и ответственных в таск-трекере (Telegram board / Jira / Linear).
- [ ] Уточнить контактные точки партнёров и маркетинга (нужно для запусков и тестов).
- [ ] Создать/обновить заметку «Release log» с целевыми версиями и датами.

---

## Фаза 1. Инфраструктура

- [ ] Neon: поднята база, включён `sslmode=require`, есть доступ в консоль.
- [ ] Render: сервис API развёрнут, задан `START_COMMAND`, подключены переменные окружения.
- [ ] Vercel: проект импортирован, билд идёт из корня, `VITE_BACKEND_URL` указывает на Render.
- [ ] Мониторинг: настроить базовую проверку `/api/health` (UptimeRobot / Render healthcheck).
- [ ] Регистрация TonAPI webhook (endpoint `/api/payments/ton/webhook`, секрет задан).

---

## Фаза 2. Backend (API & логика)

- [ ] Пройти линтер, юнит-тесты (когда появятся) и убедиться в зелёном состоянии CI.
- [ ] Проверить `POST /api/auth/ton-connect`: валидируется подпись, создаётся/обновляется пользователь, возвращается токен.
- [ ] Протестировать `POST /api/ads/complete`: кулдаун, дневной лимит, начисление энергии.
- [ ] Убедиться, что `GET /api/stats` агрегирует свежие данные (watch logs, boosts).
- [ ] Проверить `POST /api/orders/create` + webhook подтверждения.
- [ ] Актуализировать схемы БД (выделить миграции или документировать bootstrap).

---

## Фаза 3. Database & данные

- [ ] Выполнены миграции/инициализация `ensureDatabase`.
- [ ] Таблицы `users`, `user_tokens`, `watch_logs`, `reward_claims`, `orders`, `session_logs` содержат ожидаемые поля.
- [ ] Включены индексы на часто используемых колонках (`user_id`, `created_at`, `status`).
- [ ] Создана процедура/инструкция резервного копирования (Neon backups).
- [ ] Настроен доступ read-only для аналитики (если требуется).

---

## Фаза 4. Интеграция (Frontend ↔ Backend)

- [ ] `TonConnect` подключается, кошелёк отображается в Wallet.
- [ ] После авторизации `MiningScreen` получает актуальный баланс (через `/api/user/balance`).
- [ ] В Stats данные обновляются после завершения просмотра (адд OK, список логов обновлён).
- [ ] Boost покупка: клиент получает комментарий, отправляет транзакцию, статус меняется на ACTIVE.
- [ ] Partner rewards: UI показывает доступные бонусы, один раз отмечает как полученный.
- [ ] Провести end-to-end сценарий и задокументировать в разделе «Smoke test» README.

---

## Фаза 5. UX, локализация, копирайтинг

- [ ] Onboarding / глоссарий на RU/EN (минимум приветствие и пояснение CL энергии).
- [ ] Обработчики ошибок: дружелюбные сообщения вместо сырых API TEXT.
- [ ] Кнопка Withdraw — скрыта или помечена «Скоро» с подсказкой.
- [ ] Проверена адаптивность основных экранов (мобильный Telegram WebView + desktop).
- [ ] Подготовлены активы для маркетинга (`app` лендинг, Telegram посты).

---

## Фаза 6. Аналитика и антифрод

- [ ] Выбран стек аналитики (GA4 / Amplitude / PostHog).
- [ ] События интегрированы: `session_start`, `ad_view_complete`, `boost_paid`, `reward_claimed`, `referral_share`.
- [ ] Ошибки фронта отправляются в Sentry/Logtail (или аналог).
- [ ] Настроены алерты по частоте `ads/complete`, внезапным всплескам и ошибкам авторизации.
- [ ] План по антифроду: минимальная длительность просмотра, защита от ботов, лимиты рефералок.

---

## Фаза 7. Тестирование & выпуск

- [ ] Юнит/интеграционные тесты (минимум happy path) прогнаны.
- [ ] Smoke-test скрипт задокументирован и выполнен перед релизом.
- [ ] Все чекбоксы фаз 0–6 закрыты или зафиксированы как исключения с владельцем и датой.
- [ ] Выполнен релиз на `https://cladhunter.app`, сделана запись в release log.
- [ ] После релиза сверены метрики, добавлены заметки в retrospective.

---

## Определение «Готово»

1. Код в main ветке, теги релиза проставлены.
2. Документация (README, DEPLOYMENT, PRODUCT_ANALYSIS, этот файл) обновлена.
3. Все тесты и проверки зелёные.
4. Мониторинг подтверждает рабочее состояние API и фронта.
5. Стейкхолдеры уведомлены о релизе и знают, какие изменения вошли.

---

## История обновлений

- 2025-10-31 — файл полностью пересобран в чеклистовую структуру, добавлены фазы 0–7 и фиксация текущего блокера TonConnect.

